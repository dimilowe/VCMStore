1. Safelist generator
✅ scripts/generateTailwindSafelist.ts + generated/tailwindSafelist.ts is the right pattern.
Important gotcha:
If you git-ignore generated/tailwindSafelist.ts, you MUST guarantee it runs before every Tailwind compile in every environment (local, dev server, CI, production build). Otherwise builds will randomly lose gradients again.
Easiest: add something like:
"scripts": {
  "predev": "ts-node scripts/generateTailwindSafelist.ts",
  "prebuild": "ts-node scripts/generateTailwindSafelist.ts"
}
Or, if you don’t want to think about it in CI, do not git-ignore the generated file and just commit it (with a comment at the top saying “AUTOGENERATED – DO NOT EDIT”).
In tailwind.config.ts:
import { SAFELIST } from './generated/tailwindSafelist';

export default {
  // ...
  safelist: SAFELIST,
};
2. Theme tests
All good. Keep them stupid simple:
ALL_CLOUD_IDS ⇒ every one present in CLOUD_THEMES
resolveCloudId normalizes:
file-data-cloud
file_data_cloud
maybe also FILE_DATA_CLOUD just to be safe, if your CMS ever gets weird
Required tokens exist:
expect(theme.heroBg).toBeTruthy();
expect(theme.recentFilesBg).toBeTruthy();
expect(theme.promptBarBg).toBeTruthy();
If you already have Jest, use that instead of bringing in Vitest just for this. Don’t multiply tooling for no reason.
3. Cloud gallery
Perfect. Just make sure:
Route is clearly marked dev-only:
Either guard with if (process.env.NODE_ENV === 'production') notFound();
Or only include it in dev router tree.
Gallery should use the same CloudDashboardEngine the real dashboard uses, with some mock tools so you actually see gradients + cards.
Once this exists, your “is a cloud broken?” check is one page load.
4. Wire promptBarBg
Yes, add it to CLOUD_THEMES and thread it through:
CloudDashboardEngine gets theme from CLOUD_THEMES[cloudId].
CloudHero / PromptBar use theme.promptBarBg.
Rule for yourself after this:
No bg-gradient-to-* or special colors for cloud dashboards exist outside cloudTheme.ts.
If you see one, it’s a bug.
So: Yes, this is good. Let the agent start implementing exactly this.
The only thing I’d be explicit about in the prompt is:
Don’t touch dashboard JSX per cloud.
All visual differences must be expressed as new fields on CLOUD_THEMES, not inline classes.
If we stick to that, this whole category of “one cloud looks wrong” nonsense dies for good.
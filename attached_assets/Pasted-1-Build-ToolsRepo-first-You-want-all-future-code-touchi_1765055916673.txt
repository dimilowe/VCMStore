1. Build ToolsRepo first
You want all future code touching tools to go through one layer.
Implement something like:
// lib/toolsRepo.ts
export async function getToolBySlug(slug: string) {}
export async function listTools(filters: ToolFilters) {}
export async function createTool(data: NewToolInput) {}
export async function updateTool(idOrSlug, data: Partial<Tool>) {}
Wire Tool Control Panel and Engine Expansion Factory to use these functions instead of hitting the DB client directly.
This gives you:
one place to change schema later
one place to add caching if you ever want
one place to log / audit creation
2. Migrate the 47 tools from toolsRegistry.ts → DB using ToolsRepo
Write a one-off script:
Import toolsRegistry.ts.
For each tool:
keep slug identical (SEO critical)
map fields into the tools table schema:
name
slug
engine
cluster
status = 'published'
link_status = 'Ready' (if they’re already wired)
is_indexed = true (for the ones that are live)
in_directory = true (if they show in the directory)
blueprint_id = null (handmade tools)
Call ToolsRepo.createTool() for each one.
Then:
Verify Tool Control Panel shows ~47 existing tools + 32 new shells.
Spot-check a few records to make sure flags look right.
After that, toolsRegistry.ts should be data only for now, not the source of truth.
3. Update dynamic routes to use the DB
Right now, your tool pages are probably doing something like:
const tool = toolsRegistry.find(t => t.slug === params.slug);
Change that to:
const tool = await ToolsRepo.getToolBySlug(params.slug);
Short-term you can keep a fallback to avoid breaking anything while you migrate:
let tool = await ToolsRepo.getToolBySlug(params.slug);

if (!tool) {
  tool = toolsRegistry.find(t => t.slug === params.slug) ?? null;
}
Once you’ve confirmed all old tools are migrated and all slugs resolve from DB, you can rip out the fallback and kill toolsRegistry as a live dependency.
4. After that, your state looks like this
Single source of truth: tools table
Engine Expansion Factory → inserts shells via ToolsRepo
Tool Control Panel → reads from tools
Dynamic routes → resolve tools via ToolsRepo
toolsRegistry.ts → either deleted or reduced to legacy constants that don’t drive routing
That’s the clean, adult architecture.
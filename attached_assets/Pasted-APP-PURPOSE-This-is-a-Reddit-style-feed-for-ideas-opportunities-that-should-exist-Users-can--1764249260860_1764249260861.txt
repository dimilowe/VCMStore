APP PURPOSE
This is a Reddit-style feed for “ideas / opportunities that should exist.” Users can:
- Browse ideas in a vertical feed
- Sort by Hot / New / Top
- Click into a detail page for each idea
- Upvote ideas (one upvote per session)
- Leave comments on an idea
- Submit a new idea via a form

All content must be **publicly readable** and **SEO-friendly**.

ROUTES & PAGES

Base path: everything lives under /ideas for now.

1) GET /ideas
- Show the main feed.
- Query params:
  - sort=hot | new | top (default = hot)
  - tag=<tag-slug> (optional, for future)
- Render a list of idea cards.
Each card shows:
  - Upvote count + upvote button
  - Title (linking to /ideas/:slug)
  - One-liner
  - Tags
  - Meta: “X upvotes · Y comments · posted N hours/days ago”
- Top bar:
  - Simple header: “VCM Ideas Hub – Unbuilt opportunities. Share ideas you won’t build.”
  - Buttons: “Submit Idea”
  - Sorting tabs: Hot | New | Top
- Implement “hot” sort with a basic formula:
  - score = upvotes / (hours_since_created + 2)^1.5
- “New” = order by created_at DESC
- “Top” = order by upvotes DESC

2) GET /ideas/new
- Renders a form to submit a new idea.
- Fields:
  - title (required)
  - one_liner (required, 140 chars max)
  - problem (required, textarea)
  - who_it_serves (required, textarea)
  - solution (required, textarea)
  - monetization (optional, textarea)
  - why_now (optional, textarea)
  - tags (optional, comma-separated string)
- On submit, POST /ideas creates the idea and redirects to the idea’s detail page.

3) POST /ideas
- Validates required fields.
- Generates a URL-safe slug from the title; ensure uniqueness by suffixing with a short id if needed.
- Inserts into the DB.
- Redirects to GET /ideas/:slug.

4) GET /ideas/:slug
- Renders the full idea page.
- Layout:
  - Title
  - One-liner
  - Badges: tags, difficulty (for now just derive “difficulty: unknown” or leave off; we’ll add later)
  - Sections:
    - Problem
    - Who It Serves
    - Solution
    - Monetization
    - Why Now
  - Buttons:
    - Upvote (shows current count)
    - “Back to Ideas” link
  - Comments section:
    - List of comments (newest first)
    - A comment form:
      - name (optional, default “Anonymous” if missing)
      - body (required)
- Use good HTML structure and headings (h1 for title, h2 for section names) for SEO.

5) POST /ideas/:id/vote
- Increments an idea’s upvote count.
- Prevent multiple upvotes per session:
  - Use a signed cookie storing an array of idea_ids the user has voted on.
  - If the idea_id is already in the cookie’s list, do nothing (or toggle off for MVP if easier).
- Respond with a redirect back to the referring page (detail page or /ideas).

6) GET /ideas/:slug/comments (optional)
- Not required as a separate page; comments can be loaded directly with the main detail page.

7) POST /ideas/:id/comments
- Inserts a new comment into the DB:
  - idea_id
  - author_name (or “Anonymous”)
  - body
  - created_at
- Redirect back to /ideas/:slug.

DATABASE SCHEMA (SQLite)

Create a simple DB setup in /src/db:

Tables:

1) ideas
- id INTEGER PRIMARY KEY AUTOINCREMENT
- slug TEXT UNIQUE NOT NULL
- title TEXT NOT NULL
- one_liner TEXT NOT NULL
- problem TEXT NOT NULL
- who_it_serves TEXT NOT NULL
- solution TEXT NOT NULL
- monetization TEXT
- why_now TEXT
- tags TEXT  -- store comma-separated for MVP
- upvote_count INTEGER DEFAULT 0
- comment_count INTEGER DEFAULT 0
- created_at DATETIME NOT NULL
- updated_at DATETIME NOT NULL

2) idea_votes
- id INTEGER PRIMARY KEY AUTOINCREMENT
- idea_id INTEGER NOT NULL
- session_id TEXT NOT NULL  -- derived from cookie
- created_at DATETIME NOT NULL
- Unique constraint on (idea_id, session_id) to enforce one vote per session per idea.

3) comments
- id INTEGER PRIMARY KEY AUTOINCREMENT
- idea_id INTEGER NOT NULL
- author_name TEXT
- body TEXT NOT NULL
- created_at DATETIME NOT NULL

Initialize the database on server start if tables do not exist.

SESSION / COOKIE HANDLING

- Implement a lightweight session mechanism based on a signed cookie:
  - If cookie “vcm_ideas_session” does not exist, generate a random UUID and set it.
  - Use this as session_id in the idea_votes table.
- Also store a list of voted idea_ids in another signed cookie (“vcm_ideas_votes”) as a JSON array for quick lookup (no need to query idea_votes on every request just to block duplicates).

VIEWS / TEMPLATES

Use EJS templates:

- /views/layout.ejs
  - Base HTML5 layout, head tags, basic CSS link, header with site title.
  - Include a `<main><%- body %></main>` placeholder.
  - Set per-page `<title>` and `<meta name="description">` via locals.

- /views/ideas/index.ejs
  - Feed page.
  - Iterates over ideas.
  - Shows sorting tabs.
  - Each idea as a card with upvote form and summary.

- /views/ideas/new.ejs
  - Idea submission form.

- /views/ideas/show.ejs
  - Full idea page with sections and comments.

STYLING

- Use Tailwind via CDN in the layout head for quick styling:
  - Example: `<script src="https://cdn.tailwindcss.com"></script>`
- Keep design simple:
  - Light background
  - Card-style idea boxes
  - Clear typography
  - Minimal color palette

SEO REQUIREMENTS

For each idea detail page:
- `<title>` should be: `Idea: {title} – VCM Ideas Hub`
- `<meta name="description">` should be:
  - Derived from the one_liner and problem fields, truncated to ~150 chars.
- Ensure each idea page has:
  - One H1 (the idea title)
  - H2 for “Problem”, “Who It Serves”, “Solution”, “Monetization”, “Why Now”
- Add canonical link tags:
  - `<link rel="canonical" href="https://example.com/ideas/<%= idea.slug %>">`

For the feed page:
- `<title>`: `VCM Ideas Hub – Unbuilt Opportunities`
- `<meta name="description">`: short description of what the hub is.
- Paginate after e.g. 20 ideas per page and support page query param `?page=2`. This helps SEO and performance.

SITEMAP (optional but ideal)
- Add a simple sitemap generator route:
  - GET /sitemap-ideas.xml
  - Returns an XML sitemap listing all idea URLs with lastmod from updated_at.

OTHER REQUIREMENTS

- Use TypeScript for server code (ts-node or a simple build step).
- Add basic error handling (404 if idea not found, generic 500 handler).
- Provide a clear README.md with:
  - How to run locally
  - How to reset the DB
  - Description of the VCM Ideas Hub concept.

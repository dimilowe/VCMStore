3. Concrete cleanup steps
Step 1 – Drop the useless table
Run this in Neon:
DROP TABLE IF EXISTS url_registry;
Done. No more phantom registry.
Step 2 – Add cms_slug to global_urls (if not there yet)
ALTER TABLE global_urls
ADD COLUMN IF NOT EXISTS cms_slug text;
That’s the only schema change you need for URLs.
Step 3 – Update the Bulk Import API to hit global_urls
Wherever your /api/admin/cms/bulk-import route is currently doing something like:
// OLD (wrong)
INSERT INTO url_registry (path, type, cms_slug, is_indexed) ...
You change it to:
// Derive URL path based on type:
const path =
  obj.type === 'tool'
    ? `/tools/${obj.slug}`
    : obj.type === 'article'
    ? `/mbb/${obj.slug}` // or /blog/
    : `/${obj.slug}`;
Then use global_urls:
await db.$executeRawUnsafe(
  `
  INSERT INTO global_urls (url, type, cms_slug, is_indexed)
  VALUES ($1, $2, $3, false)
  ON CONFLICT (url) DO UPDATE
  SET type = EXCLUDED.type,
      cms_slug = EXCLUDED.cms_slug
  `,
  path,
  obj.type,
  obj.slug,
);
Key detail:
We do not touch is_indexed on update.
That preserves whatever you already set in the SEO Control Center.
If you later add health_score / ready_to_index columns to global_urls, you just extend that query, but the core is:
Insert new URLs with is_indexed = false
On conflict, keep the existing is_indexed
4. How this affects your SEO Control Center
Your SEO UI is already reading from global_urls. Once cms_slug is in there and Bulk Import starts populating it, you can:
Join global_urls.cms_slug → cms_objects.slug
Pull word_count, health, cluster into your SEO dashboard
Build your “Ready to Index” view off that
Something like:
SELECT
  g.url,
  g.type,
  g.is_indexed,
  g.cms_slug,
  c.word_count,
  c.health,
  c.cluster_slug
FROM global_urls g
LEFT JOIN cms_objects c ON c.slug = g.cms_slug;
That’s how your Indexing Queue and Cluster Health screens get their info.
5. Sanity check you should do once
After you drop url_registry and update the API:
Import a new CMS object via /admin/cms-import
Check cms_objects – confirm row exists
Check global_urls – confirm:
url is correct (/tools/... or /mbb/...)
type matches
cms_slug = the slug you imported
is_indexed = false
Open your SEO Control Center:
That URL should show there (via global_urls)
Toggling isIndexed should still work like before
If all that passes, you’re clean. Single URL system, no duplication, fully wired into the new CMS pipeline.